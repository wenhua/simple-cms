(function() {

  require('./zappa')(function() {
    this.enable('default layout');
    this.get({
      '/': function() {
        this.user = {
          plan: 'staff'
        };
        return this.render('index', {
          user: this.user,
          postrender: 'plans'
        });
      }
    });
    this.postrender({
      plans: function($) {
        if (this.user.plan !== 'staff') $('.staff').remove();
        return $('div.' + this.user.plan).addClass('highlighted');
      }
    });
    return this.view({
      index: function() {
        this.title = 'Post-rendering';
        this.style = '#quotas div {border: 1px solid #999; background: #eee; padding: 10px; margin: 10px}\n#quotas .highlighted {border: 3px solid #37697e; background: #d0deea}';
        h1('Quotas:');
        return div({
          id: 'quotas'
        }, function() {
          div({
            "class": 'basic'
          }, function() {
            h2('Basic');
            p('Disk: 1 GB');
            p('Bandwidth: 10 GB');
            return button({
              "class": 'staff'
            }, function() {
              return 'Change Quotas';
            });
          });
          div({
            "class": 'silver'
          }, function() {
            h2('Silver');
            p('Disk: 2 GB');
            p('RAM: 15 GB');
            return button({
              "class": 'staff'
            }, function() {
              return 'Change Quotas';
            });
          });
          div({
            "class": 'golden'
          }, function() {
            h2('Golden');
            p('Disk: 4 GB');
            p('RAM: 30 GB');
            return button({
              "class": 'staff'
            }, function() {
              return 'Change Quotas';
            });
          });
          return div({
            "class": 'staff'
          }, function() {
            h2('Staff');
            p('Disk: 10 GB');
            return p('RAM: 100 GB');
          });
        });
      }
    });
  });

}).call(this);
